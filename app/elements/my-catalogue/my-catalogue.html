<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animatable.html">
<link rel="import" href="../../bower_components/paper-styles/color.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animations.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="my-catalogue">
    <template>
        <style is="custom-style" include="iron-flex">
            :host {
                display: inline-block;
                height: 100%;
                width: 40%;
                background-color: white;

            }

            h1,
            h2 {
                text-align: center;
            }

            neon-animated-pages {
                height: calc(100% - 49px);
            }

            neon-animatable:nth-child(1),
            neon-animatable:nth-child(6) {
                background: var(--paper-blue-100);
            }

            neon-animatable:nth-child(2) {
                background: var(--paper-green-100);
            }

            neon-animatable:nth-child(3) {
                background: var(--paper-blue-100);
            }

            neon-animatable:nth-child(4) {
                background: var(--paper-green-500);
            }

            neon-animatable:nth-child(5) {
                background: var(--paper-purple-500);
            }

            paper-button.indigo {
                background-color: var(--paper-indigo-400);
                color: white;
            }

            paper-button.custom:hover {
                background-color: var(--paper-indigo-200);
            }

            label {
                margin-left: 20px;
            }

            .container>paper-button {
                width: 250px;
                margin: 5px 0px;
            }

            .checkboxList {
                margin: 5px 0px;
            }

            #button_analize {
                margin: 20px 0px;
            }

            .explicacion {
                position: relative;
                width: 50%;
                height: 50%;
                border: 1px solid #808080;
                padding: 5px;
                background-color: #eee;
                box-shadow: 2px 2px 2px 5px;
                margin: 100px;
            }

            @media (min-width: 2000px) {
                h1,
                h2 {
                    font-size: 35px;
                }
                paper-tab {
                    font-size: 20px;
                }
                .checkboxList {
                    font-size: 25px;
                }
                #button_analize {
                    width: 400px;
                    height: 80px;
                    font-size: 30px;
                }
                .explicacion {
                    font-size: 20px;
                    position: relative;
                    width: 70%;
                    height: 70%;
                    border: 1px solid #808080;
                    padding: 5px;
                    background-color: #eee;
                    box-shadow: 2px 2px 2px 5px;
                    margin: 100px;
                }
                .botones_comp>paper-button {
                    width: 400px;
                    height: 80px;
                    font-size: 22px;
                }
            }
        </style>
        <nav id="left-nav">

            <paper-tabs selected="{{selected}}">
                <paper-tab>Catálogo </paper-tab>
                <paper-tab>Analizar calidad</paper-tab>
                <paper-tab>
                    <iron-icon icon="icons:folder"></iron-icon>
                </paper-tab>
            </paper-tabs>
        </nav>
        <neon-animated-pages id="pages" selected="[[selected]]" entry-animation="[[entryAnimation]]" exit-animation="[[exitAnimation]]">
            <neon-animatable>
                <div>
                    <h1>Elige entre nuestro catálogo</h1>
                    <div class=" botones_comp container vertical layout center">
                        <template is="dom-repeat" items="{{social_network}}">
                            <paper-button raised class="custom indigo" on-click="send_ajax" data-component$="{{item.id_comp}}">Componente {{item.name}}</paper-checkbox>
                        </template>

                        <div class="explicacion center">
                            <p>Al pulsar en un componente se te pediran los atributos necesarios para hacerlo funcionar</p>
                        </div>
                    </div>
                </div>

                <!-- Donde hago la iron-ajax -->
                <iron-ajax id="request_attr" url="/api/componentes/{{component_selected}}" handle-as="json" on-response="_showform"></iron-ajax>

            </neon-animatable>
            <neon-animatable>
                <h1>Elije un componente para analizar</h1>
                <div class="checklist vertical center layout">
                    <iron-selector attr-for-selected="name" selected="foo" selected-attribute="checked" class="checkboxList vertical layout">
                        <template is="dom-repeat" items="{{social_network}}">
                            <paper-checkbox class="checkboxList" name$="{{item.name}}">{{item.name}}</paper-checkbox>
                        </template>
                    </iron-selector>
                    <paper-button raised class="custom indigo" id="button_analize" on-click="_analize">
                        Analizar
                    </paper-button>
                </div>
            </neon-animatable>
            <neon-animatable>

                <h2>Sube tu componente y analiza su calidad</h2>
                <div class="upload vertical center layout">
                    <label for="file">Upload folder</label>
                    <!-- <input type="file" id="ctrl" webkitdirectory directory multiple/> -->
                    <input type="file" name="pic" id="pic" onchange="javascript:leer()" multiple/>
                    <paper-button raised class="custom indigo" id="button_analize" on-click="_analize">
                        Analizar
                    </paper-button>
                </div>

            </neon-animatable>
        </neon-animated-pages>

    </template>
    <script>
        Polymer({
            is: 'my-catalogue',
            properties: {
                selected: {
                    type: Number,
                    value: 0
                },
                entryAnimation: {
                    type: String,
                    value: 'fade-in-animation'
                    // value: 'slide-from-left-animation'
                },
                exitAnimation: {
                    type: String,
                    value: 'fade-out-animation'
                    // value: 'slide-right-animation'
                },
                social_network: {
                    type: Array,
                    value: function () {
                        return [
                            {
                                name: "Spotify",
                                id_comp: "spotify-component"
                            },
                            {
                                name: "Facebook",
                                id_comp: "facebook-wall"
                            },
                            {
                                name: "Twitter",
                                id_comp: "twitter-timeline"
                            },
                            {
                                name: "Pinterest",
                                id_comp: "pinterest-timeline"
                            },
                            {
                                name: "Reddit",
                                id_comp: "reddit-timeline"
                            },
                            {
                                name: "Open Weather",
                                id_comp: "open-weather"
                            },
                            {
                                name: "Traffic",
                                id_comp: "traffic-incidents"
                            },
                            {
                                name: "Google +",
                                id_comp: "googleplus-timeline"
                            },
                            {
                                name: "Finance",
                                id_comp: "finance-search"
                            }

                        ]
                    }
                },
                component_selected: {
                    type: String,
                    value: ""
                }
            },
            _showform: function (evt) {
                console.log(evt.detail.response)
                this.fire("my-catalogue-click", { name: this.component_selected, data: evt.detail.response });
            },
            send_ajax: function (evt) {
<<<<<<< HEAD
                this.set('component_selected', evt.currentTarget.getAttribute('data-component'));
                this.$.request_attr.generateRequest();
=======
                console.log("hola");
            },
            leer:function (){
                var http = require('http');
                var formidable = require('formidable');
                var fs = require('fs');
                
                http.createServer(function (req, res) {
                  if (req.url == '/fileupload') {
                    var form = new formidable.IncomingForm();
                    form.parse(req, function (err, fields, files) {
                      var oldpath = files.filetoupload.path;
                      var newpath = 'C:/Users/Your Name/' + files.filetoupload.name;
                      fs.rename(oldpath, newpath, function (err) {
                        if (err) throw err;
                        res.write('File uploaded and moved!');
                        res.end();
                      });
                 });
                  } else {
                    res.writeHead(200, {'Content-Type': 'text/html'});
                    res.write('<form action="fileupload" method="post" enctype="multipart/form-data">');
                    res.write('<input type="file" name="filetoupload"><br>');
                    res.write('<input type="submit">');
                    res.write('</form>');
                    return res.end();
                  }
                }).listen(8080);
>>>>>>> contacto
            }
            
        });
    </script>
</dom-module>